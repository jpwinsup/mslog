<!doctype html><html lang=ja data-theme=light><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><title>Windows Hello および Windows Hello for Business における PIN および生体認証の登録に失敗する事象の調査</title><link rel=icon href=https://jpwinsup.github.io/mslog/images/favicon.ico><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css integrity="sha512-NhSC1YmyruXifcj/KFRWoC561YpHpc5Jtzgvbuzx5VozKpWvQ+4nXhPdFgmx8xqexRcpAglTj9sIBWINXa8x5w==" crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=https://jpwinsup.github.io/mslog/css/style.min.0884e9ffa24a703f06b6d98b2b42adddea22340fed1815ae183abb3fc616c9ef.css integrity="sha256-CITp/6JKcD8GttmLK0Kt3eoiNA/tGBWuGDq7P8YWye8=" crossorigin=anonymous><script defer data-domain=jpwinsup.github.io/mslog src=https://jpwinsup-mslog-plausible.japaneast.cloudapp.azure.com/js/script.js></script></head><body><header class="header header-color"><nav class=navbar><ul class=navbar-list><li class=navbar-item><a href=https://jpwinsup.github.io/mslog/><img class=navbar-logo src=https://jpwinsup.github.io/mslog/images/Microsoft-logo_rgb_c-wht.webp alt="Microsoft Logo"></a></li><li class=navbar-item><a class=navbar-item-style href=https://jpwinsup.github.io/mslog/>ホーム</a></li><li class=navbar-item><a class=navbar-item-style href=https://cssjpn.github.io/ target=_blank>サポート情報</a></li><li class=navbar-item><a class=navbar-item-style href=https://jpwinsup.github.io/blog/ target=_blank>サポート ブログ</a></li></ul></nav></header><div class=page-wrapper><div class="sidebar sidebar-color"><h3 class="sidebar-header sidebar-header-style">カテゴリー</h3><ul class=sidebar-list><li class="sidebar-list-item sidebar-list-item-style"><a class=sidebar-list-link-accent-style href=https://jpwinsup.github.io/mslog/directory-service/>Directory Service</a></li><li class="sidebar-list-item sidebar-list-item-style"><a class=sidebar-list-link-style href=https://jpwinsup.github.io/mslog/hyper-v/>Hyper-V</a></li><li class="sidebar-list-item sidebar-list-item-style"><a class=sidebar-list-link-style href=https://jpwinsup.github.io/mslog/cluster/>クラスター</a></li><li class="sidebar-list-item sidebar-list-item-style"><a class=sidebar-list-link-style href=https://jpwinsup.github.io/mslog/storage/>ストレージ</a></li><li class="sidebar-list-item sidebar-list-item-style"><a class=sidebar-list-link-style href=https://jpwinsup.github.io/mslog/performance/>パフォーマンス</a></li><li class="sidebar-list-item sidebar-list-item-style"><a class=sidebar-list-link-style href=https://jpwinsup.github.io/mslog/networking/>ネットワーク一般</a></li><li class="sidebar-list-item sidebar-list-item-style"><a class=sidebar-list-link-style href=https://jpwinsup.github.io/mslog/wireless/>ワイヤレス ネットワーク</a></li><li class="sidebar-list-item sidebar-list-item-style"><a class=sidebar-list-link-style href=https://jpwinsup.github.io/mslog/file-services/>ファイル サービス</a></li><li class="sidebar-list-item sidebar-list-item-style"><a class=sidebar-list-link-style href=https://jpwinsup.github.io/mslog/uwp/>UWP</a></li><li class="sidebar-list-item sidebar-list-item-style"><a class=sidebar-list-link-style href=https://jpwinsup.github.io/mslog/rdp/>リモートアクセス</a></li><li class="sidebar-list-item sidebar-list-item-style"><a class=sidebar-list-link-style href=https://jpwinsup.github.io/mslog/core/>コア</a></li><li class="sidebar-list-item sidebar-list-item-style"><a class=sidebar-list-link-style href=https://jpwinsup.github.io/mslog/other/>その他</a></li><li class="sidebar-list-item sidebar-list-item-style"><a class=sidebar-list-link-style href=https://jpwinsup.github.io/mslog/faq/>FAQ</a></li></ul></div><div class="content content-color"><article><h1>Windows Hello および Windows Hello for Business における PIN および生体認証の登録に失敗する事象の調査</h1><h3>目次</h3><nav id=TableOfContents><ul><li><a href=#本資料が有効なシナリオ>本資料が有効なシナリオ</a></li><li><a href=#採取いただく資料>採取いただく資料</a></li><li><a href=#資料採取時の影響について>資料採取時の影響について</a></li><li><a href=#対象機器>対象機器</a></li><li><a href=#情報採取手順>情報採取手順</a><ul><li><a href=#1-事象再現時のログ採取>1. 事象再現時のログ採取</a></li><li><a href=#2-事象再現後のログ採取>2. 事象再現後のログ採取</a></li></ul></li></ul></nav><p>本記事はマイクロソフト社員によって公開されております。<br>いつも弊社製品をご利用いただきまして誠にありがとうございます。<br>本サイトでは弊社にお問い合わせいただく際に、事前に採取しておいたほうが良い内容についてご紹介しております。<br>このページでは「Windows Hello および Windows Hello for Business における PIN および生体認証の登録に失敗する事象の調査」に必要な資料採取についてご紹介いたします。</p><h2 id=本資料が有効なシナリオ>本資料が有効なシナリオ</h2><hr><ul><li>Windows Hello および Windows Hello for Business における PIN および生体認証の登録に失敗する</li></ul><h2 id=採取いただく資料>採取いただく資料</h2><hr><ul><li>パケット キャプチャー</li><li>Process Monitor</li><li>OS 構成情報</li><li>イベント ログ</li><li>認証関連トレース ログ</li><li>問題ステップ記録ツール</li></ul><p>など</p><h2 id=資料採取時の影響について>資料採取時の影響について</h2><hr><p>ログ採取中は各種リソースに多少の負荷がかかる可能性がございますが、通常実影響はございません。<br>また、OS 再起動の必要はございません。</p><h2 id=対象機器>対象機器</h2><hr><ul><li>PIN もしくは生体認証の登録に失敗する事象が発生しているクライアント</li></ul><h2 id=情報採取手順>情報採取手順</h2><hr><h3 id=1-事象再現時のログ採取>1. 事象再現時のログ採取</h3><p>採取対象機器にて、以下のリンクを参考に情報採取を実施していただきますようお願いいたします。</p><p><a href=https://jpwinsup.github.io/mslog/directory-service/manuals/tss_normal_auth_pm/>TSS 情報採取手順</a></p><p>手順内 [2] 事象の再現 においては、以下の順序にて事象を再現させます。<br>事象再現後は、リンク先の [3] TSS.ps1 ログの採取停止 の手順に沿って情報採取を停止します。</p><h4 id=事象再現順序>事象再現順序</h4><ol><li>設定画面を閉じた状態とします。</li><li>Windows キー を押しながら R を押下し、[ファイルを指定して実行] にて &ldquo;services.msc&rdquo; と入力し、Enter キーを押下します。</li><li>&ldquo;Windows Biometric Service&rdquo; を右クリックし、[再起動] をクリックします。</li><li>Windows Hello もしくは Windows Hello for Business における PIN および生体認証の登録を実施し、登録に失敗する事象を再現させます。</li></ol><h3 id=2-事象再現後のログ採取>2. 事象再現後のログ採取</h3><p>事象が発生するユーザーの権限でコマンド プロンプトを開き、以下のコマンドを実行します。<br>実行結果は C:\MS_DATA\UserInfo というフォルダ配下に出力されますので、[1. 事象再現時のログ採取] で採取した情報と併せて、C:\MS_DATA 配下の情報をすべて弊社までお寄せください。</p><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>    md C:\MS_DATA\UserInfo
</span></span><span style=display:flex><span>    cd C:\MS_DATA\UserInfo
</span></span><span style=display:flex><span>    gpresult /h %USERNAME%_gpr.html
</span></span><span style=display:flex><span>    gpresult /z &gt; %USERNAME%_gpr.txt
</span></span><span style=display:flex><span>    whoami /all &gt; %USERNAME%_whoami.txt
</span></span><span style=display:flex><span>    whoami /upn &gt; %USERNAME%_upn.txt
</span></span><span style=display:flex><span>    dsregcmd /status &gt; %USERNAME%_dsregcmd.txt
</span></span><span style=display:flex><span>    dsregcmd /listaccounts &gt; %USERNAME%_listaccounts.txt
</span></span><span style=display:flex><span>    cmdkey /list &gt; %USERNAME%_cmdkey.txt
</span></span><span style=display:flex><span>    vaultcmd /listcreds:{4BF4C442-9B8A-41A0-B380-DD4A704DDB28} /all  &gt; %USERNAME%_vaultcmd.txt
</span></span><span style=display:flex><span>    klist &gt; %USERNAME%_klist.txt
</span></span><span style=display:flex><span>    klist cloud_debug &gt; %USERNAME%_klist_cloud.txt
</span></span><span style=display:flex><span>    certutil -v -user -store my &gt; %USERNAME%_mystore.txt
</span></span><span style=display:flex><span>    reg query HKCU /s &gt; %USERNAME%_hkcu.txt
</span></span><span style=display:flex><span>    dir %userprofile% /a /s &gt; %USERNAME%_dir.txt
</span></span></code></pre></div><p>手順は以上でございます。<br>本情報の内容（添付文書、リンク先などを含む）は、作成日時点でのものであり、予告なく変更される場合があります。</p></article></div></div><footer class="footer footer-color"><div class=footer-container><img class=footer-logo src=https://jpwinsup.github.io/mslog/images/Microsoft-logo_rgb_c-wht.webp alt="Microsoft Logo"><nav class=footer-links><ul class=footer-links-list><li class=footer-links-item><a class=footer-links-style href=https://jpwinsup.github.io/mslog/>ホーム</a></li><li class=footer-links-item><a class=footer-links-style href=https://cssjpn.github.io/ target=_blank>サポート情報</a></li><li class=footer-links-item><a class=footer-links-style href=https://jpwinsup.github.io/blog/ target=_blank>サポート ブログ</a></li></ul></nav></div><p class="footer-copy footer-copy-style">© 2023 Microsoft Japan Windows サポート チーム</p></footer></body></html>