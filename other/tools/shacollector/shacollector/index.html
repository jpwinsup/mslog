<!doctype html><html lang=ja data-theme=light><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><title>shacollector について</title><link rel=icon href=https://jpwinsup.github.io/mslog/images/favicon.ico><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css integrity="sha512-NhSC1YmyruXifcj/KFRWoC561YpHpc5Jtzgvbuzx5VozKpWvQ+4nXhPdFgmx8xqexRcpAglTj9sIBWINXa8x5w==" crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=https://jpwinsup.github.io/mslog/css/style.min.2cf2d83b70054c6a1f941ece9e04f670c1ca9e5d7906b9f613c2128026f68c85.css integrity="sha256-LPLYO3AFTGoflB7OngT2cMHKnl15Brn2E8ISgCb2jIU=" crossorigin=anonymous><script defer data-domain=jpwinsup.github.io/mslog src=https://jpwinsup-mslog-plausible.japaneast.cloudapp.azure.com/js/script.js></script></head><body><header class="header header-color"><nav class=navbar><ul class=navbar-list><li class=navbar-item><a href=https://jpwinsup.github.io/mslog/><img class=navbar-logo src=https://jpwinsup.github.io/mslog/images/Microsoft-logo_rgb_c-wht.webp alt="Microsoft Logo"></a></li><li class=navbar-item><a class=navbar-item-style href=https://jpwinsup.github.io/mslog/>ホーム</a></li><li class=navbar-item><a class=navbar-item-style href=https://cssjpn.github.io/ target=_blank>サポート情報</a></li><li class=navbar-item><a class=navbar-item-style href=https://jpwinsup.github.io/blog/ target=_blank>サポート ブログ</a></li></ul></nav></header><div class=page-wrapper><div class="sidebar sidebar-color"><h3 class="sidebar-header sidebar-header-style">カテゴリー</h3><ul class=sidebar-list><li class="sidebar-list-item sidebar-list-item-style"><a class=sidebar-list-link-style href=https://jpwinsup.github.io/mslog/directory-service/>Directory Service</a></li><li class="sidebar-list-item sidebar-list-item-style"><a class=sidebar-list-link-style href=https://jpwinsup.github.io/mslog/hyper-v/>Hyper-V</a></li><li class="sidebar-list-item sidebar-list-item-style"><a class=sidebar-list-link-style href=https://jpwinsup.github.io/mslog/cluster/>クラスター</a></li><li class="sidebar-list-item sidebar-list-item-style"><a class=sidebar-list-link-style href=https://jpwinsup.github.io/mslog/storage/>ストレージ</a></li><li class="sidebar-list-item sidebar-list-item-style"><a class=sidebar-list-link-style href=https://jpwinsup.github.io/mslog/performance/>パフォーマンス</a></li><li class="sidebar-list-item sidebar-list-item-style"><a class=sidebar-list-link-style href=https://jpwinsup.github.io/mslog/networking/>ネットワーク一般</a></li><li class="sidebar-list-item sidebar-list-item-style"><a class=sidebar-list-link-style href=https://jpwinsup.github.io/mslog/wireless/>ワイヤレス ネットワーク</a></li><li class="sidebar-list-item sidebar-list-item-style"><a class=sidebar-list-link-style href=https://jpwinsup.github.io/mslog/file-services/>ファイル サービス</a></li><li class="sidebar-list-item sidebar-list-item-style"><a class=sidebar-list-link-style href=https://jpwinsup.github.io/mslog/uwp/>UWP</a></li><li class="sidebar-list-item sidebar-list-item-style"><a class=sidebar-list-link-style href=https://jpwinsup.github.io/mslog/rdp/>リモートアクセス</a></li><li class="sidebar-list-item sidebar-list-item-style"><a class=sidebar-list-link-style href=https://jpwinsup.github.io/mslog/core/>コア</a></li><li class="sidebar-list-item sidebar-list-item-style"><a class=sidebar-list-link-accent-style href=https://jpwinsup.github.io/mslog/other/>その他</a></li></ul></div><div class="content content-color"><article><h1>shacollector について</h1><h3>目次</h3><nav id=TableOfContents><ul><li><a href=#description>DESCRIPTION</a></li><li><a href=#whats-new-in-this-version-80>What&rsquo;s New in this Version 8.0</a></li><li><a href=#faq>FAQ</a></li><li><a href=#how-to-use-it>How to use it</a></li><li><a href=#example>EXAMPLE</a></li><li><a href=#usage>Usage</a><ul><li><a href=#available-trace-option>available trace option:</a></li><li><a href=#available-performance-option>available performance option:</a></li><li><a href=#available-support-option>available support option:</a></li><li><a href=#update-history>Update History:</a></li></ul></li></ul></nav><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>    Script Name: shacollector.bat
</span></span><span style=display:flex><span>    Purpose:     collect support information logs related to SHA Area. 
</span></span><span style=display:flex><span>    Version:     8.0
</span></span><span style=display:flex><span>    Last Update: 14th Sep 2022
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Developer:      Shohei Sadashima / Konan Morimoto / Koji Ishida / Norimasa Okawa / Jun Nakayamada / Takahiro Aizawa
</span></span><span style=display:flex><span>    Email-Alias: shsadash / kojii / nookawa / junakaya / taaizawa
</span></span></code></pre></div><h2 id=description>DESCRIPTION</h2><p>shacollector is a tool that makes it easy to collect data for problem solving which is included in trace logs (ETW),
performance logs (perfmon or xperf), event logs and a lot of status information related to SHA area (Storage, Cluster and Hyper-V).</p><h2 id=whats-new-in-this-version-80>What&rsquo;s New in this Version 8.0</h2><ul><li>add vhd trace option @Koji Ishida</li></ul><h2 id=faq>FAQ</h2><p>Q. 資料採取時の負荷、および、ログサイズの目安を教えてほしい。</p><blockquote><p>A. スペックにも依存するため一概にお伝えすることができませんが、弊社内での確認結果 (参考値) を以下に記載します。<br>下記をもとに採取をご検討いただきますようお願い申し上げます。</p><ol><li><p>トレースログ</p><ul><li>CPU/メモリ負荷<ul><li>実行前<ul><li>CPU (プロセッサ数 2 ): 約 2 ~ 4 % 使用</li><li>メモリ(4 GB): 約 10 % 使用</li></ul></li><li>ログ採取時<ul><li>CPU (プロセッサ数 2 ): ピークで約 10 ～ 15 %上昇 (平均 5 % 程度上昇)</li><li>メモリ(4 GB): 約 3 % 上昇</li></ul></li></ul></li><li>ログサイズ : 約 3.6 GB　</li></ul></li><li><p>サポート ログ (support all オプション)</p><ul><li>CPU/メモリ負荷<ul><li>実行前<ul><li>CPU (プロセッサ数 2 ): 約 2 ~ 4 % 使用</li><li>メモリ(4 GB): 約 15 % 使用</li></ul></li><li>ログ採取時<ul><li>CPU (プロセッサ数 2 ): ピークで 約10 ～ 15 % 上昇 (平均 5 ％程度上昇）</li><li>メモリ(4 GB): 約 4 % 上昇</li></ul></li></ul></li><li>ログサイズ：約 4 GB　</li></ul></li></ol></blockquote><p>Q. support all の取得時間について教えてほしい</p><blockquote><p>A. 大半のケースにおいては 1 時間以内で完了するものの、取得時間は環境に大きく依存するため、正確な時間をお伝えすることができません。</p></blockquote><p>Q. support all の取得の際、msinfo32 の取得に時間がかかる場合の回避策について教えてほしい</p><blockquote><p>A. support all ではなく、support nomsinfo オプションをご利用ください。<br>support nomsinfo オプションは msinfo32 の取得のみを省略しており、msinfo32 以外は support all と同じログを取得します。<br>shacollector.bat support nomsinfo &lt;保存先></p></blockquote><p>Q. support all 取得中に途中で終了したい場合はどうすればいいか教えてほしい</p><blockquote><p>A. support all を実行しているコマンドプロンプトで Ctrl + C を入力し、<br>”バッチ ジョブを終了しますか (Y/N)?” に Y で応答してください。<br>なお、msinfo 取得中に強制終了したい場合は、タスクマネージャーを開き、msinfo32.exe を強制終了してください。</p></blockquote><p>Q. support all の取得が完了したことを確認する方法を教えてほしい</p><blockquote><p>A. コマンドプロンプト上、&ldquo;Start msinfo32 &mldr; done&rdquo; まで記録されていれば、support all の最後まで取得が完了しています。</p></blockquote><p>Q. 資料採取時に一時ファイルは作成されますか？</p><blockquote><p>A. はい、support all オプションでイベントログを取得の際、以下のパスに一時ファイルが作成されるケースが報告されています。<br>C:\Windows\ServiceProfiles\LocalService\AppDate\Local\Temp\<br>大きなイベントログが存在する場合、上記の一時ファイルの容量も大きくなるため、容量に余裕が無い場合には、support all の出力先として他のドライブを保存先として指定することをご検討ください。<br>shacollector.bat support all &lt;出力先></p></blockquote><h2 id=how-to-use-it>How to use it</h2><p>First, specify main options (trace, perf and support) and select sub option that specifies the information to collect.
Then, &rsquo;trace&rsquo; and &lsquo;perf&rsquo; can be specified with &lsquo;start&rsquo; to start and &lsquo;stop&rsquo; to stop log collection.
The &lsquo;support&rsquo; option collects various status information and logs without specifying &lsquo;start&rsquo; and &lsquo;stop&rsquo;.
By default, logs are saved in &lsquo;c:\mslog&rsquo;, but you can specify the output destination.</p><h2 id=example>EXAMPLE</h2><ul><li>To collect trace log related I/O drivers (storport.sys, classpnp &mldr;).
And change the output folder to &rsquo;d:\logs&rsquo;.</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>shacollector.bat trace storage start d:\logs
</span></span><span style=display:flex><span>shacollector.bat trace storage stop
</span></span></code></pre></div><ul><li>To specify log file size in MB. default size is 4096 MB.</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>shacollector.bat trace storage start size 1024 d:\logs
</span></span><span style=display:flex><span>shacollector.bat trace storage stop
</span></span></code></pre></div><ul><li>To collect multiple trace logs (ex. storport and vss). The log files are saved in &lsquo;c:\mslog&rsquo; as the default.</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>shacollector.bat trace storport start
</span></span><span style=display:flex><span>shacollector.bat trace vss start
</span></span><span style=display:flex><span>shacollector.bat trace storport stop
</span></span><span style=display:flex><span>shacollector.bat trace vss stop
</span></span></code></pre></div><ul><li>To collect trace log (ex. storport) at OS startup.</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>shacollector.bat trace storport boot
</span></span><span style=display:flex><span>&lt;restart OS&gt;
</span></span><span style=display:flex><span>shacollector.bat trace storport stop
</span></span><span style=display:flex><span>shacollector.bat trace storport delete
</span></span></code></pre></div><ul><li>To collect performance monitor log. The sample interval is 15sec as the default but it can be change.</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>shacollector.bat perf perfmon start
</span></span><span style=display:flex><span>shacollector.bat perf perfmon stop
</span></span></code></pre></div><ul><li>To collect performance monitor log at 1 sec as sample interval. And change the output folder to &rsquo;d:\logs&rsquo;.</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>shacollector.bat perf perfmon start d:\logs interval 0:0:1
</span></span><span style=display:flex><span>shacollector.bat perf perfmon stop
</span></span></code></pre></div><ul><li>To collect performance monitor log at 1 sec as sample interval. And change the output folder to &rsquo;d:\logs&rsquo; And to specify 7 days as retention days (default 3 days).</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>shacollector.bat perf perfmon start d:\logs interval 0:0:1 days 7
</span></span><span style=display:flex><span>shacollector.bat perf perfmon stop
</span></span></code></pre></div><ul><li>To collect xperf log for investigating the cpu load. And change the output folder to &rsquo;d:\logs&rsquo;.</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>shacollector.bat perf cpu start d:\logs
</span></span><span style=display:flex><span>shacollector.bat perf cpu stop
</span></span></code></pre></div><ul><li>To specify log file size 4096 MB. default size is 8192 MB.</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>shacollector.bat perf cpu start size 4096 d:\logs
</span></span><span style=display:flex><span>shacollector.bat perf cpu stop
</span></span></code></pre></div><ul><li>To collect xperf log for investigating the memory exhaustion. The log files are saved in &lsquo;c:\mslog&rsquo; as the default.</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>shacollector.bat perf memory start
</span></span><span style=display:flex><span>shacollector.bat perf memory stop
</span></span></code></pre></div><ul><li>To collect xperf log for investigating the I/O load. The log files are saved in &lsquo;c:\mslog&rsquo; as the default.</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>shacollector.bat perf disk start
</span></span><span style=display:flex><span>shacollector.bat perf disk stop
</span></span></code></pre></div><ul><li>To collect all relevant support information logs such as event logs, registry, dik and network configuration and so on. And change the output folder to &rsquo;d:\logs&rsquo;.</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>shacollector.bat support all d:\logs
</span></span></code></pre></div><ul><li>To collect all relevant support information logs without msinfo32. And change the output folder to &rsquo;d:\logs&rsquo;.</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>shacollector.bat support nomsinfo d:\logs
</span></span></code></pre></div><ul><li>To collect specific support information logs (disk, network and event logs).</li></ul><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>shacollector.bat support disk
</span></span><span style=display:flex><span>shacollector.bat support network
</span></span><span style=display:flex><span>shacollector.bat support eventlog
</span></span></code></pre></div><h2 id=usage>Usage</h2><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>shacollector.bat trace [trace option] start size [Maximum log file size in MB (default 4096 MB)] [output folder (default c:\mslog)]
</span></span><span style=display:flex><span>shacollector.bat trace [trace option] stop
</span></span><span style=display:flex><span>shacollector.bat trace [trace option] boot size [Maximum log file size in MB (default 4096 MB)] [output folder (default c:\mslog)]
</span></span><span style=display:flex><span>shacollector.bat trace [trace option] delete
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>shacollector.bat perf perfmon start [output folder (default c:\mslog)] interval [sample interval [hh:mm:ss] (ex. 00:00:15) default 15sec] days [retention days (default 3 days)]
</span></span><span style=display:flex><span>shacollector.bat perf cpu start size [Maximum log file size in MB (default 8192 MB)] [output folder (default c:\mslog)]
</span></span><span style=display:flex><span>shacollector.bat perf cpu stop
</span></span><span style=display:flex><span>shacollector.bat perf memory start size [Maximum log file size in MB (default 8192 MB)] [output folder (default c:\mslog)] tag &#34;POOL TAG (ex. FMfn)&#34;
</span></span><span style=display:flex><span>shacollector.bat perf memory stop
</span></span><span style=display:flex><span>shacollector.bat perf disk start size [Maximum log file size in MB (default 8192 MB)] [output folder (default c:\mslog)]
</span></span><span style=display:flex><span>shacollector.bat perf disk stop
</span></span><span style=display:flex><span>shacollector.bat perf delay start size [Maximum log file size in MB (default 8192 MB)] [output folder (default c:\mslog)]
</span></span><span style=display:flex><span>shacollector.bat perf delay stop
</span></span><span style=display:flex><span>shacollector.bat perf heap start pid &#34;Process ID (ex. 1234)&#34; enable
</span></span><span style=display:flex><span>shacollector.bat perf heap start [output folder (default c:\mslog)] pid &#34;Process ID (ex. 1234)&#34; snap
</span></span><span style=display:flex><span>shacollector.bat perf heap stop
</span></span><span style=display:flex><span>shacollector.bat perf boot start [output folder (default c:\mslog)] 
</span></span><span style=display:flex><span>shacollector.bat perf boot stop
</span></span><span style=display:flex><span>shacollector.bat support all [output folder (default c:\mslog)]
</span></span><span style=display:flex><span>shacollector.bat support basic [output folder (default c:\mslog)]
</span></span><span style=display:flex><span>shacollector.bat support [supportlog option] [output folder (default c:\mslog)]
</span></span><span style=display:flex><span>shacollector.bat support nomsinfo [output folder (default c:\mslog)]
</span></span></code></pre></div><h3 id=available-trace-option>available trace option:</h3><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>storage   collecting storage drivers trace. (ex storport.sys, classpnp.sys ...)
</span></span><span style=display:flex><span>storport  collecting storport driver trace.
</span></span><span style=display:flex><span>ntfs      collecting NTFS driver trace.
</span></span><span style=display:flex><span>usb       collecting USB drivers trace.
</span></span><span style=display:flex><span>pnp       collecting Plug and Play drivers trace.
</span></span><span style=display:flex><span>com       collecting COM/COM+ services trace.
</span></span><span style=display:flex><span>vds       collecting VDS services trace. (Windows Server 2012 or later)
</span></span><span style=display:flex><span>vss       collecting VSS services trace. (Windows Server 2008 R2 or later)
</span></span><span style=display:flex><span>wsb       collecting Windows Server Backup modules trace. (Windows Server 2008 R2 or later)
</span></span><span style=display:flex><span>cdrom     collecting CD/DVD modules trace.
</span></span><span style=display:flex><span>ata       collecting ATAPort drivers trace.
</span></span><span style=display:flex><span>fsrm      collecting FSRM drivers trace.
</span></span><span style=display:flex><span>dedup     collecting Dedup drivers trace. (Windows Server 2012 or later)
</span></span><span style=display:flex><span>nfs       collecting NFS services trace.
</span></span><span style=display:flex><span>network   collecting Network driver trace.
</span></span><span style=display:flex><span>iscsi     collecting iSCSI driver trace.
</span></span><span style=display:flex><span>csv       collecting CSV drivers trace.
</span></span><span style=display:flex><span>wmi       collecting WMI services trace.
</span></span><span style=display:flex><span>rpc       collecting RPC services trace.
</span></span><span style=display:flex><span>hyper-v   collecting Hyper-V modules trace.
</span></span><span style=display:flex><span>cluster   collecting Failover Clustering trace (included netft trace).
</span></span><span style=display:flex><span>space     collecting Storage Space trace.
</span></span><span style=display:flex><span>storagereplica     collecting Storage Replica trace.
</span></span><span style=display:flex><span>msdtc     collecting MSDTC trace.
</span></span><span style=display:flex><span>fltmgr    collecting Filter Manager trace.
</span></span><span style=display:flex><span>packet    collecting Network Packet Capture. (Windows Server 2008 R2 or later)
</span></span><span style=display:flex><span>procmon   collecting Process Monitor log of Sysinternals.
</span></span><span style=display:flex><span>psr       collecting Problems Steps Recorder log. (maxlogsize is 10MB)
</span></span><span style=display:flex><span>refs      collecting ReFS drivers trace.
</span></span><span style=display:flex><span>storsvc   collecting Storage Sensor Service trace.
</span></span><span style=display:flex><span>vhd       collecting VHD trace.
</span></span></code></pre></div><h3 id=available-performance-option>available performance option:</h3><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>perfmon   collecting Performance Monitor log. default sample interval is 15sec. default retention term is 3 days.
</span></span><span style=display:flex><span>cpu       collecting CPU perf logs with Xperf.
</span></span><span style=display:flex><span>memory    collecting Memory perf logs with Xperf.
</span></span><span style=display:flex><span>disk      collecting Disk perf logs with Xperf.
</span></span><span style=display:flex><span>delay     collecting Delay perf logs with Xperf.
</span></span><span style=display:flex><span>heap      collectiong Heap performance log with rdrleakdiag.
</span></span></code></pre></div><h3 id=available-support-option>available support option:</h3><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>all             collecting all support logs.
</span></span><span style=display:flex><span>   included cluster, disk, diskshadow, driverinfo, eventlog, fltmc, fsrm, handle, hyper-v, iscsi, network, nfs, registry, storagereplica, system, setup, taskscheduler, vss
</span></span><span style=display:flex><span>basic           collecting basic support logs.
</span></span><span style=display:flex><span>   included disk, driverinfo, eventlog, fltmc, network, system, vss
</span></span><span style=display:flex><span>cluster         collecting cluster information logs.
</span></span><span style=display:flex><span>disk            collecting disk information logs.
</span></span><span style=display:flex><span>diskshadow      collecting diskshadow information logs.
</span></span><span style=display:flex><span>driverinfo      collecting driver information logs.
</span></span><span style=display:flex><span>drive-space     collecting drive space information logs.
</span></span><span style=display:flex><span>eventlog        collecting eventlog information logs.
</span></span><span style=display:flex><span>fltmc           collecting filter driver information logs.
</span></span><span style=display:flex><span>fsrm            collecting fsrm information logs.
</span></span><span style=display:flex><span>handle          collecting file handle information.
</span></span><span style=display:flex><span>hyper-v         collecting hyper-v information logs.
</span></span><span style=display:flex><span>iscsi           collecting iscsi information logs.
</span></span><span style=display:flex><span>network         collecting network information logs.
</span></span><span style=display:flex><span>nfs             collecting nfs information logs.
</span></span><span style=display:flex><span>registry        collecting registry information logs.
</span></span><span style=display:flex><span>storagereplica  collecting Storage Replica information logs.
</span></span><span style=display:flex><span>system          collecting system information logs.
</span></span><span style=display:flex><span>system-nomsinfo collecting system information logs without msinfo32.
</span></span><span style=display:flex><span>taskscheduler   collecting task scheduler information logs.
</span></span><span style=display:flex><span>virtualfc       collecting virtual fc information.
</span></span><span style=display:flex><span>vss             collecting vss information logs.
</span></span><span style=display:flex><span>setup           collecting setup information logs.
</span></span><span style=display:flex><span>fsi             collecting file system information logs.
</span></span><span style=display:flex><span>crash           generate blue screen of death (BSOD).
</span></span><span style=display:flex><span>nomsinfo        collecting all support logs without msinfo32.
</span></span></code></pre></div><h3 id=update-history>Update History:</h3><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>2018/07/30 v1.0 making @Koji Ishida.
</span></span><span style=display:flex><span>2018/09/21 v1.1 add WinRM event log @Koji Ishida.
</span></span><span style=display:flex><span>2018/11/12 v1.2 add Hyper-V trace @Koji Ishida.
</span></span><span style=display:flex><span>2018/11/15 v1.3 add Storage Space trace @Koji Ishida.
</span></span><span style=display:flex><span>2018/11/19 v1.4 add S2D and Network information @Koji Ishida.
</span></span><span style=display:flex><span>2018/12/25 v1.5 add setup logs @Koji Ishida
</span></span><span style=display:flex><span>2019/01/17 v1.6 add mpclaim output @Koji Ishida
</span></span><span style=display:flex><span>2019/02/18 v1.7 add nfs and storage replica configuration @Koji Ishida
</span></span><span style=display:flex><span>2019/03/27 v1.8 add Windows Firewall info in Network @Koji Ishida
</span></span><span style=display:flex><span>2019/03/29 v1.9 add packet capture for boot mode @Koji Ishida
</span></span><span style=display:flex><span>2019/03/29 v2.0 add diskshadow and autmount log @Koji Ishida
</span></span><span style=display:flex><span>2019/04/15 v2.1 add get VMQ config @Koji Ishida
</span></span><span style=display:flex><span>2019/05/27 v2.2 add FailoverClustering-Manager trace and Hyper-V information @Koji Ishida
</span></span><span style=display:flex><span>2019/05/31 v2.3 implement to check admin authority. @Koji Ishida
</span></span><span style=display:flex><span>2019/06/04 v2.4 add NFS infomation and iSCSI information @Koji Ishida
</span></span><span style=display:flex><span>2019/07/03 v2.5 implement to change output folder @Koji Ishida
</span></span><span style=display:flex><span>2019/07/09 v2.6 fix a bug @Koji Ishida
</span></span><span style=display:flex><span>2019/09/13 v2.7 implement to get all application and service log files @Koji Ishida
</span></span><span style=display:flex><span>2019/09/14 v2.8 implement showvminfo for 2008 R2/2012 of Hyper-V @Koji Ishida
</span></span><span style=display:flex><span>2019/09/15 v2.9 implement procmon/perfmon/xperf @Koji Ishida
</span></span><span style=display:flex><span>2019/09/20 v3.0 implement dir/du/fsutil/chkdsk/defrag @Jun Nakayamada
</span></span><span style=display:flex><span>2019/10/01 v3.1 change vmms and vmwp trace log size 64MB to 1GB.
</span></span><span style=display:flex><span>2019/10/04 v3.2 fix a bug @Jun Nakayamada
</span></span><span style=display:flex><span>2019/10/10 v3.3 add VSS logs to drive space information logs
</span></span><span style=display:flex><span>2019/10/16 v3.4 fix a bug for perfmon and disable collecting diskshadow @Koji Ishida
</span></span><span style=display:flex><span>2019/10/17 v3.5 add crash, handle and netft option @Koji Ishida
</span></span><span style=display:flex><span>2019/11/01 v3.5 modify vss trace flag to 0x00000fff @Koji Ishida
</span></span><span style=display:flex><span>2019/11/09 v3.6 modify hyper-v trace and xperf stop behavior @Koji Ishida
</span></span><span style=display:flex><span>2019/11/10 v3.7 implement to get eventlog files with csv type. modify pefmon/procmon. implement get-virtualfc @Koji Ishida
</span></span><span style=display:flex><span>2020/01/07 v4.0 new implementation @Koji Ishida
</span></span><span style=display:flex><span>2020/01/16 v4.1 fix a bug for perfmon @Koji Ishida
</span></span><span style=display:flex><span>2020/01/17 v4.2 add setup logs for support @Koji Ishida
</span></span><span style=display:flex><span>2020/01/22 v4.3 add RDMA Activity counter for perfmon @Koji Ishida
</span></span><span style=display:flex><span>2020/01/23 v4.4 add S2D information for support @Koji Ishida
</span></span><span style=display:flex><span>2020/01/24 v4.5 add restart task for perfmon @Koji Ishida
</span></span><span style=display:flex><span>2020/01/24 v4.6 fix the wrong path was specified for perfmon @Koji Ishida
</span></span><span style=display:flex><span>2020/02/05 v4.7 modify perfmon counter list for perfmon @Koji Ishida
</span></span><span style=display:flex><span>2020/03/10 v4.8 modify cdrom trace @Koji Ishida
</span></span><span style=display:flex><span>2020/03/23 v4.9 add support fsi option @Norimasa Okawa
</span></span><span style=display:flex><span>2020/03/25 v5.0 add perf heap option @Norimasa Okawa
</span></span><span style=display:flex><span>2020/04/16 v5.1 modify support fsi option @Koji Ishida
</span></span><span style=display:flex><span>2020/05/07 v5.2 add ntfs trace @Koji Ishida
</span></span><span style=display:flex><span>2020/05/11 v5.3 implement to avoid double execution of perfmon @Koji Ishida
</span></span><span style=display:flex><span>2020/05/18 v5.4 implement to avoid double execution of trace @Koji Ishida
</span></span><span style=display:flex><span>2020/06/18 v5.5 add virtual-fc trace in hyper-v trace @Koji Ishida
</span></span><span style=display:flex><span>2020/06/29 v5.6 add MSDTC trace @Shohei Sadashima
</span></span><span style=display:flex><span>2020/07/10 v5.7 fix the data collector set name of hyper-v trace. @Koji Ishida
</span></span><span style=display:flex><span>2020/07/28 v5.8 add collecting core information for support log  and supports nfs version 4 tracing. @Koji Ishida
</span></span><span style=display:flex><span>2020/09/01 v5.9 add get-ClusterNode command result @Konan Morimoto
</span></span><span style=display:flex><span>2020/09/25 v6.0 transport the shacollector version info to the option.txt. @Shohei Sadashima
</span></span><span style=display:flex><span>2021/03/05 v6.1 implement size option/add filter manager trace/implement boot option for procmon/implement days option for perfmon. @Koji Ishida
</span></span><span style=display:flex><span>2021/03/24 v6.2 implement add refs driver trace. @Koji Ishida
</span></span><span style=display:flex><span>2021/04/05 v6.3 fix the handling of perf memory. @Koji Ishida
</span></span><span style=display:flex><span>2021/04/07 v6.4 modify drive-space logs @Jun Nakayamada, Add folder option to MSDTC trace @Shohei Sadashima 
</span></span><span style=display:flex><span>2021/05/07 v6.5 add Get-ClusterSharedVolumeState to the cluster infomation. @Shohei Sadashima
</span></span><span style=display:flex><span>2021/05/28 v6.6 add Get-ClusterQuorum to the cluster infomation. @Shohei Sadashima / Update Tools @Koji Ishida
</span></span><span style=display:flex><span>2021/07/01 v6.7 add Dynamic Memory for Hyper-V trace @Koji Ishida
</span></span><span style=display:flex><span>2021/07/07 v6.8 implement EULA @Koji Ishida
</span></span><span style=display:flex><span>2021/11/17 v6.9 add registry information in perf/disk and add time/data information in option.txt. @Yudong Ma 
</span></span><span style=display:flex><span>2022/01/20 v7.0 add boot trace for performance log option@Takahiro Aizawa / implement to handle powershell execution policy @Koji Ishida
</span></span><span style=display:flex><span>2022/01/21 v7.1 add partmgr GUID for storage.bat / add network info for network support log. @Koji Ishida
</span></span><span style=display:flex><span>2022/02/22 v7.2 refresh WPT files. @Koji Ishida
</span></span><span style=display:flex><span>2022/02/22 v7.3 delete Zone.Identifier stream. @Koji Ishidaq
</span></span><span style=display:flex><span>2022/02/25 v7.4 add storsvc trace (Storage Sensor). @Koji Ishida
</span></span><span style=display:flex><span>2022/03/03 v7.5 add Get-MpPreference in system.bat of support. @Norimasa Okawa
</span></span><span style=display:flex><span>2022/05/10 v7.6 change wmic and Get-WmiObject to Get-CimInstance. @Norimasa Okawa
</span></span><span style=display:flex><span>2022/06/24 v7.7 add registry information for Storage Sensor. @Shohei Sadashima
</span></span><span style=display:flex><span>2022/07/07 v7.8 add NTFS compression info for drive-space. @Koji Ishida
</span></span><span style=display:flex><span>2022/07/27 v7.9 add nomsinfo option @Shohei Sadashima
</span></span><span style=display:flex><span>2022/09/14 v8.0 add vhd trace option @Koji Ishida
</span></span></code></pre></div></article></div></div><footer class="footer footer-color"><div class=footer-container><img class=footer-logo src=https://jpwinsup.github.io/mslog/images/Microsoft-logo_rgb_c-wht.webp alt="Microsoft Logo"><nav class=footer-links><ul class=footer-links-list><li class=footer-links-item><a class=footer-links-style href=https://jpwinsup.github.io/mslog/>ホーム</a></li><li class=footer-links-item><a class=footer-links-style href=https://cssjpn.github.io/ target=_blank>サポート情報</a></li><li class=footer-links-item><a class=footer-links-style href=https://jpwinsup.github.io/blog/ target=_blank>サポート ブログ</a></li></ul></nav></div><p class="footer-copy footer-copy-style">© 2023 Microsoft Japan Windows サポート チーム</p></footer></body></html>