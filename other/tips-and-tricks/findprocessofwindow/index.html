<!doctype html><html lang=ja data-theme=light><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><title>Window を表示させたプロセスを見つける</title><link rel=icon href=https://jpwinsup.github.io/mslog/images/favicon.ico><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css integrity="sha512-NhSC1YmyruXifcj/KFRWoC561YpHpc5Jtzgvbuzx5VozKpWvQ+4nXhPdFgmx8xqexRcpAglTj9sIBWINXa8x5w==" crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=https://jpwinsup.github.io/mslog/css/style.min.2cf2d83b70054c6a1f941ece9e04f670c1ca9e5d7906b9f613c2128026f68c85.css integrity="sha256-LPLYO3AFTGoflB7OngT2cMHKnl15Brn2E8ISgCb2jIU=" crossorigin=anonymous><script defer data-domain=jpwinsup.github.io/mslog src=http://mslog-plausible.japaneast.cloudapp.azure.com/js/script.js></script></head><body><header class="header header-color"><nav class=navbar><ul class=navbar-list><li class=navbar-item><a href=https://jpwinsup.github.io/mslog/><img class=navbar-logo src=https://jpwinsup.github.io/mslog/images/Microsoft-logo_rgb_c-wht.webp alt="Microsoft Logo"></a></li><li class=navbar-item><a class=navbar-item-style href=https://jpwinsup.github.io/mslog/>ホーム</a></li><li class=navbar-item><a class=navbar-item-style href=https://cssjpn.github.io/ target=_blank>サポート情報</a></li><li class=navbar-item><a class=navbar-item-style href=https://jpwinsup.github.io/blog/ target=_blank>サポート ブログ</a></li></ul></nav></header><div class=page-wrapper><div class="sidebar sidebar-color"><h3 class="sidebar-header sidebar-header-style">カテゴリー</h3><ul class=sidebar-list><li class="sidebar-list-item sidebar-list-item-style"><a class=sidebar-list-link-style href=https://jpwinsup.github.io/mslog/directory-service/>Directory Service</a></li><li class="sidebar-list-item sidebar-list-item-style"><a class=sidebar-list-link-style href=https://jpwinsup.github.io/mslog/hyper-v/>Hyper-V</a></li><li class="sidebar-list-item sidebar-list-item-style"><a class=sidebar-list-link-style href=https://jpwinsup.github.io/mslog/cluster/>クラスター</a></li><li class="sidebar-list-item sidebar-list-item-style"><a class=sidebar-list-link-style href=https://jpwinsup.github.io/mslog/storage/>ストレージ</a></li><li class="sidebar-list-item sidebar-list-item-style"><a class=sidebar-list-link-style href=https://jpwinsup.github.io/mslog/performance/>パフォーマンス</a></li><li class="sidebar-list-item sidebar-list-item-style"><a class=sidebar-list-link-style href=https://jpwinsup.github.io/mslog/networking/>ネットワーク一般</a></li><li class="sidebar-list-item sidebar-list-item-style"><a class=sidebar-list-link-style href=https://jpwinsup.github.io/mslog/wireless/>ワイヤレス ネットワーク</a></li><li class="sidebar-list-item sidebar-list-item-style"><a class=sidebar-list-link-style href=https://jpwinsup.github.io/mslog/file-services/>ファイル サービス</a></li><li class="sidebar-list-item sidebar-list-item-style"><a class=sidebar-list-link-style href=https://jpwinsup.github.io/mslog/uwp/>UWP</a></li><li class="sidebar-list-item sidebar-list-item-style"><a class=sidebar-list-link-style href=https://jpwinsup.github.io/mslog/rdp/>リモートアクセス</a></li><li class="sidebar-list-item sidebar-list-item-style"><a class=sidebar-list-link-style href=https://jpwinsup.github.io/mslog/core/>コア</a></li><li class="sidebar-list-item sidebar-list-item-style"><a class=sidebar-list-link-accent-style href=https://jpwinsup.github.io/mslog/other/>その他</a></li></ul></div><div class="content content-color"><article><h1>Window を表示させたプロセスを見つける</h1><h3>目次</h3><nav id=TableOfContents><ul><li><a href=#作業の流れ>作業の流れ</a><ul><li><a href=#process-explorer-ツールの-zip-ファイルをダウンロード展開>Process Explorer ツールの zip ファイルをダウンロード・展開</a></li><li><a href=#process-explorer-ツールでプロセスを特定しプロセス-ダンプを出力>Process Explorer ツールでプロセスを特定し、プロセス ダンプを出力</a></li></ul></li></ul></nav><p>本記事はマイクロソフト社員によって公開されております。</p><p>いつも弊社製品をご利用いただきまして誠にありがとうございます。Windows プラットフォーム サポートの栗木です。</p><p>今回は、<a href=https://docs.microsoft.com/en-us/sysinternals/downloads/process-explorer target=_blank>Process Explorer ツール</a> を利用し、表示されたWindow (エラーメッセージ等)がどのプロセスによって表示されたか確認する方法をご紹介します。また、そのプロセスが Window を表示させたスタックを確認するためにプロセス ダンプの出力方法もあわせてご紹介いたします。本記事では、例として以下のエラーメッセージを表示させたプロセスを探していきます。</p><p><img src=https://jpwinsup.github.io/mslog/other/tips-and-tricks/findprocessofwindow/unexpected.png alt></p><h2 id=作業の流れ>作業の流れ</h2><ol><li>Process Explorer ツールの zip ファイルをダウンロード・展開</li><li>Process Explorer ツールでプロセスを特定し、プロセス ダンプを出力</li></ol><h3 id=process-explorer-ツールの-zip-ファイルをダウンロード展開>Process Explorer ツールの zip ファイルをダウンロード・展開</h3><p>以下の Web サイトから Process Explorer ツールをダウンロードし、任意のフォルダに展開します。
Process Explorer：https://docs.microsoft.com/en-us/sysinternals/downloads/process-explorer</p><h3 id=process-explorer-ツールでプロセスを特定しプロセス-ダンプを出力>Process Explorer ツールでプロセスを特定し、プロセス ダンプを出力</h3><ol><li><p>Process Explorer を管理者として実行し、上部の黒いターゲット アイコンを確認します。</p><p><img src=https://jpwinsup.github.io/mslog/other/tips-and-tricks/findprocessofwindow/ProcessExplorer.png alt></p></li><li><p>ターゲット アイコンをクリックしたまま Window (エラーメッセージ等) までドラッグします。ドラッグ中は、マウス ポインタがターゲット アイコンに変化します。</p></li><li><p>Window 上でドラッグを解除します。解除すると Window を表示させたプロセスが、Process Explorer 上でハイライトされます。
以下の例では、<strong>msgbox.exe</strong> が Window を表示させたことが確認できました。</p><p><img src=https://jpwinsup.github.io/mslog/other/tips-and-tricks/findprocessofwindow/MsgBox.png alt></p></li><li><p>ハイライトされている Window を表示させたプロセスを右クリックし、<strong>Create Dump</strong> -> <strong>Create Full Dump</strong> を選択し、プロセス ダンプを出力します。
なお、プロセス ダンプを出力するまで Window は表示させたままにしておいてください。</p><p><img src=https://jpwinsup.github.io/mslog/other/tips-and-tricks/findprocessofwindow/FullDump.png alt></p></li></ol><p>出力されたプロセス ダンプを windbg で解析することで Window を表示させたスタックが確認できます。</p><p>本情報の内容（添付文書、リンク先などを含む）は、作成日時点でのものであり、予告なく変更される場合があります。</p></article></div></div><footer class="footer footer-color"><div class=footer-container><img class=footer-logo src=https://jpwinsup.github.io/mslog/images/Microsoft-logo_rgb_c-wht.webp alt="Microsoft Logo"><nav class=footer-links><ul class=footer-links-list><li class=footer-links-item><a class=footer-links-style href=https://jpwinsup.github.io/mslog/>ホーム</a></li><li class=footer-links-item><a class=footer-links-style href=https://cssjpn.github.io/ target=_blank>サポート情報</a></li><li class=footer-links-item><a class=footer-links-style href=https://jpwinsup.github.io/blog/ target=_blank>サポート ブログ</a></li></ul></nav></div><p class="footer-copy footer-copy-style">© 2023 Microsoft Japan Windows サポート チーム</p></footer></body></html>