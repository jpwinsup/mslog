<!doctype html><html lang=ja data-theme=light><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><title>OS 起動からファイルやレジストリへのアクセスを確認する</title><link rel=icon href=https://jpwinsup.github.io/mslog/images/favicon.ico><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css integrity="sha512-NhSC1YmyruXifcj/KFRWoC561YpHpc5Jtzgvbuzx5VozKpWvQ+4nXhPdFgmx8xqexRcpAglTj9sIBWINXa8x5w==" crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=https://jpwinsup.github.io/mslog/css/style.min.0884e9ffa24a703f06b6d98b2b42adddea22340fed1815ae183abb3fc616c9ef.css integrity="sha256-CITp/6JKcD8GttmLK0Kt3eoiNA/tGBWuGDq7P8YWye8=" crossorigin=anonymous><script defer data-domain=jpwinsup.github.io/mslog src=https://jpwinsup-mslog-plausible.japaneast.cloudapp.azure.com/js/script.js></script></head><body><header class="header header-color"><nav class=navbar><ul class=navbar-list><li class=navbar-item><a href=https://jpwinsup.github.io/mslog/><img class=navbar-logo src=https://jpwinsup.github.io/mslog/images/Microsoft-logo_rgb_c-wht.webp alt="Microsoft Logo"></a></li><li class=navbar-item><a class=navbar-item-style href=https://jpwinsup.github.io/mslog/>ホーム</a></li><li class=navbar-item><a class=navbar-item-style href=https://cssjpn.github.io/ target=_blank>サポート情報</a></li><li class=navbar-item><a class=navbar-item-style href=https://jpwinsup.github.io/blog/ target=_blank>サポート ブログ</a></li></ul></nav></header><div class=page-wrapper><div class="sidebar sidebar-color"><h3 class="sidebar-header sidebar-header-style">カテゴリー</h3><ul class=sidebar-list><li class="sidebar-list-item sidebar-list-item-style"><a class=sidebar-list-link-style href=https://jpwinsup.github.io/mslog/directory-service/>Directory Service</a></li><li class="sidebar-list-item sidebar-list-item-style"><a class=sidebar-list-link-style href=https://jpwinsup.github.io/mslog/hyper-v/>Hyper-V</a></li><li class="sidebar-list-item sidebar-list-item-style"><a class=sidebar-list-link-style href=https://jpwinsup.github.io/mslog/cluster/>クラスター</a></li><li class="sidebar-list-item sidebar-list-item-style"><a class=sidebar-list-link-style href=https://jpwinsup.github.io/mslog/storage/>ストレージ</a></li><li class="sidebar-list-item sidebar-list-item-style"><a class=sidebar-list-link-style href=https://jpwinsup.github.io/mslog/performance/>パフォーマンス</a></li><li class="sidebar-list-item sidebar-list-item-style"><a class=sidebar-list-link-style href=https://jpwinsup.github.io/mslog/networking/>ネットワーク一般</a></li><li class="sidebar-list-item sidebar-list-item-style"><a class=sidebar-list-link-style href=https://jpwinsup.github.io/mslog/wireless/>ワイヤレス ネットワーク</a></li><li class="sidebar-list-item sidebar-list-item-style"><a class=sidebar-list-link-style href=https://jpwinsup.github.io/mslog/file-services/>ファイル サービス</a></li><li class="sidebar-list-item sidebar-list-item-style"><a class=sidebar-list-link-style href=https://jpwinsup.github.io/mslog/uwp/>UWP</a></li><li class="sidebar-list-item sidebar-list-item-style"><a class=sidebar-list-link-style href=https://jpwinsup.github.io/mslog/rdp/>リモートアクセス</a></li><li class="sidebar-list-item sidebar-list-item-style"><a class=sidebar-list-link-style href=https://jpwinsup.github.io/mslog/core/>コア</a></li><li class="sidebar-list-item sidebar-list-item-style"><a class=sidebar-list-link-accent-style href=https://jpwinsup.github.io/mslog/other/>その他</a></li><li class="sidebar-list-item sidebar-list-item-style"><a class=sidebar-list-link-style href=https://jpwinsup.github.io/mslog/faq/>FAQ</a></li></ul></div><div class="content content-color"><article><h1>OS 起動からファイルやレジストリへのアクセスを確認する</h1><h3>目次</h3><nav id=TableOfContents><ul><li><a href=#process-monitor-ログ取得手順os-起動から>Process Monitor ログ取得手順（OS 起動から）</a></li><li><a href=#process-monitor-ログ解析>Process Monitor ログ解析</a></li></ul></nav><p>本記事はマイクロソフト社員によって公開されております。</p><p>いつも弊社製品をご利用いただきまして誠にありがとうございます。Windows プラットフォーム サポートの栗木です。<br>今回は、Process Monitor ツールにより、OS 起動からファイルやレジストリへのアクセス状況を確認する方法をご紹介いたします。<br>Process Monitor は弊社が無償で公開している Sysinternals に含まれるツールの一つで、プロセスによるファイルやレジストリへのアクセス、プロセスやスレッドの起動や終了といったアクティビティについて、記録や解析を行うことが可能です。</p><p>OS 起動からではない期間のログ取得方法については、以下の記事でご案内しております。<br>Process Monitor ログの採取手順<br><a href=https://jpdscore.github.io/blog/debugging/collect-procmon/ target=_blank>https://jpdscore.github.io/blog/debugging/collect-procmon/</a></p><h2 id=process-monitor-ログ取得手順os-起動から>Process Monitor ログ取得手順（OS 起動から）</h2><ol><li><p>以下のサイトからProcess Monitor をダウンロードします。<br>Process Monitor - Sysinternals | Microsoft Learn<br><a href=https://learn.microsoft.com/en-us/sysinternals/downloads/procmon target=_blank>https://learn.microsoft.com/en-us/sysinternals/downloads/procmon</a></p></li><li><p>ダウンロードした ProcessMonitor.zip をの任意のフォルダーに置き、展開します。</p></li><li><p>Procmon64.exe を実行します。</p></li><li><p>管理者権限が必要であるため、権限が不足している場合は、昇格ダイアログが表示されます。</p></li><li><p>Process Monitor の起動後、自動的にファイルシステム、レジストリ、プロセスおよびスレッドの活動の記録を開始し始めます。</p></li><li><p>四角のアイコン（[Capture] ボタン) をクリックし、まだログを取得する必要がないため、記録を停止します。</p><p><img src=https://jpwinsup.github.io/mslog/other/tips-and-tricks/checkfileandregistryaccess/capture1.png alt></p></li><li><p>記録を停止すると、四角のアイコン（[Capture] ボタン) のハイライトがなくなります。</p><p><img src=https://jpwinsup.github.io/mslog/other/tips-and-tricks/checkfileandregistryaccess/capture2.png alt></p></li><li><p>ゴミ箱アイコン（[Clear] ボタン）をクリックし、記録されたログを削除します。ログを削除すると左下に No events (capture disabled) と表示されています。</p><p><img src=https://jpwinsup.github.io/mslog/other/tips-and-tricks/checkfileandregistryaccess/noevents.png alt></p></li><li><p>メニューの[Options]–[Enable Boot Logging] をクリックし、次回のOS起動からログ採取をスタートする設定をします。</p><p><img src=https://jpwinsup.github.io/mslog/other/tips-and-tricks/checkfileandregistryaccess/EnableBootLogging.png alt></p></li><li><p>以下のダイアログで、[Generate thread profiling events] のチェックは不要なのでそのまま [OK] をクリックします。</p><p><img src=https://jpwinsup.github.io/mslog/other/tips-and-tricks/checkfileandregistryaccess/ThreadProfiling.png alt></p></li><li><p>Procmon64.exe を終了し、OS を再起動します。OS 起動からログ採取が自動的開始されます。</p></li><li><p>OS が再起動したらログインし、Procmon64.exe を実行します。</p></li><li><p>以下のダイアログが表示されるので、[はい] をクリックし、ログを保存します。デフォルトでは、Bootlog.pml というファイル名となり、任意の場所に保存できます。</p><p><img src=https://jpwinsup.github.io/mslog/other/tips-and-tricks/checkfileandregistryaccess/booted.png alt></p><p>[補足: シャットダウン時のログが取りたい場合]<br>シャットダウン時のログが取りたい場合は、上記の手順12. でログインした後、Procmon64.exe を実行せず、そのままOSを再起動します。その再起動後に、Procmon64.exe を実行し、ログを保存します。</p></li></ol><h2 id=process-monitor-ログ解析>Process Monitor ログ解析</h2><ol><li><p>漏斗アイコン（[Filter] ボタン）をクリックし、フィルターを設定します。</p><p><img src=https://jpwinsup.github.io/mslog/other/tips-and-tricks/checkfileandregistryaccess/filter.png alt></p></li><li><p>[Path-contains-ファイルまたはレジストリパス]を設定し、Add ボタンをクリックし、フィルターに追加します。</p><p><img src=https://jpwinsup.github.io/mslog/other/tips-and-tricks/checkfileandregistryaccess/test.png alt></p></li><li><p>OKボタンをクリックして、フィルター設定を完了します。</p><p><img src=https://jpwinsup.github.io/mslog/other/tips-and-tricks/checkfileandregistryaccess/okay.png alt></p></li><li><p>フィルター結果からアクセスしたプロセスを確認します。
以下の例では、エクスプローラーやメモ帳が test.txt にアクセスしていたことが確認できます。</p><p><img src=https://jpwinsup.github.io/mslog/other/tips-and-tricks/checkfileandregistryaccess/result.png alt></p></li></ol><p>本情報の内容（添付文書、リンク先などを含む）は、作成日時点でのものであり、予告なく変更される場合があります。</p></article></div></div><footer class="footer footer-color"><div class=footer-container><img class=footer-logo src=https://jpwinsup.github.io/mslog/images/Microsoft-logo_rgb_c-wht.webp alt="Microsoft Logo"><nav class=footer-links><ul class=footer-links-list><li class=footer-links-item><a class=footer-links-style href=https://jpwinsup.github.io/mslog/>ホーム</a></li><li class=footer-links-item><a class=footer-links-style href=https://cssjpn.github.io/ target=_blank>サポート情報</a></li><li class=footer-links-item><a class=footer-links-style href=https://jpwinsup.github.io/blog/ target=_blank>サポート ブログ</a></li></ul></nav></div><p class="footer-copy footer-copy-style">© 2023 Microsoft Japan Windows サポート チーム</p></footer></body></html>