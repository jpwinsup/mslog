<!doctype html><html lang=ja data-theme=light><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><title>OS が起動しない事象が発生した場合の調査</title><link rel=icon href=https://jpwinsup.github.io/mslog/images/favicon.ico><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css integrity="sha512-NhSC1YmyruXifcj/KFRWoC561YpHpc5Jtzgvbuzx5VozKpWvQ+4nXhPdFgmx8xqexRcpAglTj9sIBWINXa8x5w==" crossorigin=anonymous referrerpolicy=no-referrer><link rel=stylesheet href=https://jpwinsup.github.io/mslog/css/style.min.0884e9ffa24a703f06b6d98b2b42adddea22340fed1815ae183abb3fc616c9ef.css integrity="sha256-CITp/6JKcD8GttmLK0Kt3eoiNA/tGBWuGDq7P8YWye8=" crossorigin=anonymous><script defer data-domain=jpwinsup.github.io/mslog src=https://jpwinsup-mslog-plausible.japaneast.cloudapp.azure.com/js/script.js></script></head><body><header class="header header-color"><nav class=navbar><ul class=navbar-list><li class=navbar-item><a href=https://jpwinsup.github.io/mslog/><img class=navbar-logo src=https://jpwinsup.github.io/mslog/images/Microsoft-logo_rgb_c-wht.webp alt="Microsoft Logo"></a></li><li class=navbar-item><a class=navbar-item-style href=https://jpwinsup.github.io/mslog/>ホーム</a></li><li class=navbar-item><a class=navbar-item-style href=https://cssjpn.github.io/ target=_blank>サポート情報</a></li><li class=navbar-item><a class=navbar-item-style href=https://jpwinsup.github.io/blog/ target=_blank>サポート ブログ</a></li></ul></nav></header><div class=page-wrapper><div class="sidebar sidebar-color"><h3 class="sidebar-header sidebar-header-style">カテゴリー</h3><ul class=sidebar-list><li class="sidebar-list-item sidebar-list-item-style"><a class=sidebar-list-link-style href=https://jpwinsup.github.io/mslog/directory-service/>Directory Service</a></li><li class="sidebar-list-item sidebar-list-item-style"><a class=sidebar-list-link-style href=https://jpwinsup.github.io/mslog/hyper-v/>Hyper-V</a></li><li class="sidebar-list-item sidebar-list-item-style"><a class=sidebar-list-link-style href=https://jpwinsup.github.io/mslog/cluster/>クラスター</a></li><li class="sidebar-list-item sidebar-list-item-style"><a class=sidebar-list-link-style href=https://jpwinsup.github.io/mslog/storage/>ストレージ</a></li><li class="sidebar-list-item sidebar-list-item-style"><a class=sidebar-list-link-accent-style href=https://jpwinsup.github.io/mslog/performance/>パフォーマンス</a></li><li class="sidebar-list-item sidebar-list-item-style"><a class=sidebar-list-link-style href=https://jpwinsup.github.io/mslog/networking/>ネットワーク一般</a></li><li class="sidebar-list-item sidebar-list-item-style"><a class=sidebar-list-link-style href=https://jpwinsup.github.io/mslog/wireless/>ワイヤレス ネットワーク</a></li><li class="sidebar-list-item sidebar-list-item-style"><a class=sidebar-list-link-style href=https://jpwinsup.github.io/mslog/file-services/>ファイル サービス</a></li><li class="sidebar-list-item sidebar-list-item-style"><a class=sidebar-list-link-style href=https://jpwinsup.github.io/mslog/uwp/>UWP</a></li><li class="sidebar-list-item sidebar-list-item-style"><a class=sidebar-list-link-style href=https://jpwinsup.github.io/mslog/rdp/>リモートアクセス</a></li><li class="sidebar-list-item sidebar-list-item-style"><a class=sidebar-list-link-style href=https://jpwinsup.github.io/mslog/core/>コア</a></li><li class="sidebar-list-item sidebar-list-item-style"><a class=sidebar-list-link-style href=https://jpwinsup.github.io/mslog/other/>その他</a></li><li class="sidebar-list-item sidebar-list-item-style"><a class=sidebar-list-link-style href=https://jpwinsup.github.io/mslog/faq/>FAQ</a></li></ul></div><div class="content content-color"><article><h1>OS が起動しない事象が発生した場合の調査</h1><h3>目次</h3><nav id=TableOfContents><ul><li><a href=#os-が起動しない事象が発生した場合の調査>OS が起動しない事象が発生した場合の調査</a></li><li><a href=#確認項目>確認項目</a></li><li><a href=#資料採取>資料採取</a></li><li><a href=#os-起動画面の例>OS 起動画面の例</a></li><li><a href=#補足情報>補足情報</a></li></ul></nav><h2 id=os-が起動しない事象が発生した場合の調査>OS が起動しない事象が発生した場合の調査</h2><p>本記事はマイクロソフト社員によって公開されております。</p><p>いつも弊社製品をご利用いただきまして誠にありがとうございます。Windows プラットフォーム サポートの栗木です。<br>弊社にお問い合わせいただく際に、発生事象の確認項目と事前に採取しておいたほうがよい資料についてご紹介させていただきます。<br>今回のテーマは「OS が起動しない事象が発生した場合の調査について」です。</p><h2 id=確認項目>確認項目</h2><p>起動しなくなった端末の状況を把握するため、以下をご確認してください。</p><ol><li>OS 起動が止まった画面 (<a href=#OS-%e8%b5%b7%e5%8b%95%e7%94%bb%e9%9d%a2%e3%81%ae%e4%be%8b>OS 起動画面の例</a>)</li><li>OS のバージョン (Windows 10,11、Windows Server 2012,2016,2019,2022等)</li><li>物理環境 or 仮想環境 (Azure、VMWare等)</li><li>起動しなくなった端末のバックアップの有無</li><li>起動しなくなる前に実施した作業内容とシステムへの変更点</li><li>適用した更新プログラム（更新プログラム適用後に起動できなくなった場合）</li></ol><h2 id=資料採取>資料採取</h2><p>Windows 回復環境からコマンド プロンプトを立ち上げて資料採取を行います。コマンド プロンプトは、Windows OS のインストール メディアから起動し、Shift+F10 キーを入力しても起動できます。<br>回復環境での作業ができない仮想環境の場合は、起動可能な他の仮想マシンに起動しなくなった端末のディスクをマウントして、起動可能な他の仮想マシンでコマンド プロンプトを実行し、作業を進めてください。</p><ol><li><p>[オプションの選択] 画面にて[トラブルシューティング] - [詳細オプション] - [コマンド プロンプト]の順に選択します。</p><p><img src=https://jpwinsup.github.io/mslog/Performance/NoBoot/no-boot/re.png alt></p></li><li><p>コマンドプロンプト (cmd.exe) 画面にて、dir コマンドを用いて、C: から順に Windows フォルダの有無を確認します。<br>※ システムが正常時に起動している際には、通常 C ドライブ配下に Windows フォルダがございます。しかし、システムが正常に起動しない際には、異なる場合がございますので、ご確認をお願いいたします。</p><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>X:\Source&gt;dir D:
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>2013/08/22  23:50  &lt;DIR&gt;  Program Files 
</span></span><span style=display:flex><span>2013/08/23  00:39  &lt;DIR&gt;  Program Files (x86)
</span></span><span style=display:flex><span>2018/03/26  21:19  &lt;DIR&gt;  Users
</span></span><span style=display:flex><span>2018/03/26  21:48  &lt;DIR&gt;  Windows  &lt;-----------------------
</span></span><span style=display:flex><span>...
</span></span></code></pre></div><p>※ この実行例では、D ドライブに Windows フォルダが存在するため、D ドライブがシステム ドライブです。以降の手順はシステム ドライブが D ドライブを前提にご説明いたします。</p></li><li><p>資料を保存するために、USB フラッシュ メモリなど挿入します。</p></li><li><p>以下のコマンドを実行します。<br>これらのコマンドにより、ブート設定、ディスク情報、システム ファイル情報、イベントログ、Setup ログ、CBS ログ、起動ログ、Windows Update 関連ログ、DISM ログ、レジストリファイル、適用している更新プログラムの情報、ページファイル、メモリ ダンプが取得できます。</p><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>mkdir E:\MSLogs
</span></span><span style=display:flex><span>bcdedit /enum &gt; E:\MSLogs\bcdedit.txt
</span></span><span style=display:flex><span>bcdedit /enum /v &gt; E:\MSLogs\bcdedit-v.txt
</span></span><span style=display:flex><span>bcdedit /enum all &gt; E:\MSLogs\bcdeditAll.txt
</span></span><span style=display:flex><span>bcdedit /enum all /v &gt; E:\MSLogs\bcdeditAll-v.txt
</span></span><span style=display:flex><span>echo list dis | diskpart &gt; E:\MSLogs\diskpart.txt
</span></span><span style=display:flex><span>echo list vol | diskpart &gt;&gt; E:\MSLogs\diskpart.txt
</span></span><span style=display:flex><span>dir /t:c /a /s /c /n D:\ &gt; E:\MSLogs\dir-systemdrive.log
</span></span><span style=display:flex><span>xcopy D:\Windows\System32\winevt\Logs\*.* E:\MSLogs\EventLogs\
</span></span><span style=display:flex><span>xcopy D:\Windows\inf\Setupapi*.log E:\MSLogs\SetupAPI\
</span></span><span style=display:flex><span>xcopy D:\Windows\Logs\CBS\*.* E:\MSLogs\CBS\
</span></span><span style=display:flex><span>xcopy D:\WINDOWS\system32\LogFiles\Srt\SrtTrail.txt E:\MSLogs\SrtTrail.txt
</span></span><span style=display:flex><span>xcopy D:\Windows\Logs\WindowsUpdate E:\MSLogs\WindowsUpdate\
</span></span><span style=display:flex><span>xcopy D:\ProgramData\USOShared\Logs E:\MSLogs\USOShared\
</span></span><span style=display:flex><span>xcopy D:\Windows\Logs\DISM E:\MSLogs\DISM\
</span></span><span style=display:flex><span>copy D:\Windows\SoftwareDistribution\ReportingEvents.log E:\MSLogs\ReportingEvents.log
</span></span><span style=display:flex><span>copy D:\Windows\System32\config\SYSTEM E:\MSLogs\SYSTEM
</span></span><span style=display:flex><span>copy D:\Windows\System32\config\SOFTWARE E:\MSLogs\SOFTWARE
</span></span><span style=display:flex><span>copy D:\Windows\System32\config\RegBack\SYSTEM E:\MSLogs\RegBackSYSTEM
</span></span><span style=display:flex><span>copy D:\Windows\System32\config\RegBack\SOFTWARE E:\MSLogs\RegBackSOFTWARE
</span></span><span style=display:flex><span>dism /image:D:\ /get-packages /ScratchDir:D:\ /format:table &gt; E:\MSLogs\Get-Packages.txt
</span></span><span style=display:flex><span>xcopy /h D:\pagefile.sys E:\MSLogs\pagefile.sys
</span></span><span style=display:flex><span>copy D:\Windows\memory.dmp E:\MSLogs\MEMORY.dmp
</span></span><span style=display:flex><span>注：ページングファイル (pagefile.sys) や メモリダンプ (MEMORY.dmp) のパス設定を変更している場合は、パスを変更してください。
</span></span></code></pre></div><p>※ 上記はシステム ドライブが D: で認識され、E ドライブ (外付け HDD や、USB フラッシュ ディスクなど) にコピーする例になります。手順 2 の確認結果および外付けドライブが認識されたドライブによってドライブレターが環境によって異なりますので、環境に合わせて変更ください。</p><p>※ コマンド実行時にエラーが発生した場合、一旦その内容は無視いただき採取できた資料をご提供ください。可能であればエラー画面のスクリーンショットをご提供ください。</p></li><li><p>ご採取いただきました資料を弊社にご提供ください。<br>※ 上記の例の場合、E:\MSLogs に保存されますので、E:\MSLogs フォルダを圧縮いただき弊社に送付ください。</p></li></ol><h2 id=os-起動画面の例>OS 起動画面の例</h2><ol><li><p>なにも表示されていない黒い画面
<img src=https://jpwinsup.github.io/mslog/performance/NoBoot/no-boot/black.png alt></p></li><li><p>Logo と Progress Circle が表示されている画面 (Logo は、端末のメーカーが表示される場合があります。)
<img src=https://jpwinsup.github.io/mslog/performance/NoBoot/no-boot/LogoAndCircle.png alt></p></li><li><p>黒い背景に Progress Circle が表示されている画面
<img src=https://jpwinsup.github.io/mslog/performance/NoBoot/no-boot/circle.png alt></p></li><li><p>お待ちくださいと Progress Circle が表示されている画面
<img src=https://jpwinsup.github.io/mslog/performance/NoBoot/no-boot/wait.png alt></p></li><li><p>Blue Screen of Death (BSoD、ブルースクリーン)
<img src=https://jpwinsup.github.io/mslog/performance/NoBoot/no-boot/bsod.png alt></p></li><li><p>回復環境（OS の起動が複数回連続して失敗した後、回復環境で起動する場合があります。）
<img src=https://jpwinsup.github.io/mslog/performance/NoBoot/no-boot/re.png alt></p></li></ol><h2 id=補足情報>補足情報</h2><p>外付けの HDD やUSB などのフラッシュメモリを用いた現地での資料採取ができない場合には、リモートのネットワーク共有フォルダをコピー先に使用してデータを抽出してください。<br>回復環境は既定でネットワークが無効になっておりますので、この方法を用いる場合には、共有フォルダにコピーする前に、回復環境でコマンドプロンプトを起動したのち、以下のコマンドを実行しネットワークインターフェースを構成する必要があります。</p><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>startnet.cmd
</span></span><span style=display:flex><span>netsh interface ipv4 set address &lt;インタフェース名またはインデックス&gt; static &lt;IP アドレス&gt; &lt;サブネットマスク&gt;
</span></span></code></pre></div><p>インターフェース名/インデックスの確認方法</p><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>netsh interface ipv4 show interfaces
</span></span></code></pre></div><p>ネットワークドライブへの接続</p><div class=highlight><pre tabindex=0 style=color:#c9d1d9;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback><span style=display:flex><span>net use &lt;ドライブ文字:&gt; &lt;共有フォルダのパス名&gt; /user:&lt;接続するアカウント&gt; &lt;パスワード&gt;
</span></span></code></pre></div><p>本情報の内容（添付文書、リンク先などを含む）は、作成日時点でのものであり、予告なく変更される場合があります。</p></article></div></div><footer class="footer footer-color"><div class=footer-container><img class=footer-logo src=https://jpwinsup.github.io/mslog/images/Microsoft-logo_rgb_c-wht.webp alt="Microsoft Logo"><nav class=footer-links><ul class=footer-links-list><li class=footer-links-item><a class=footer-links-style href=https://jpwinsup.github.io/mslog/>ホーム</a></li><li class=footer-links-item><a class=footer-links-style href=https://cssjpn.github.io/ target=_blank>サポート情報</a></li><li class=footer-links-item><a class=footer-links-style href=https://jpwinsup.github.io/blog/ target=_blank>サポート ブログ</a></li></ul></nav></div><p class="footer-copy footer-copy-style">© 2023 Microsoft Japan Windows サポート チーム</p></footer></body></html>